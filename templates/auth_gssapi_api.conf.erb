
<LocationMatch ^/api(/v2)?/users/extlogin/?$>
  SSLRequireSSL
  <If "%{HTTP:Authorization} =~ /^Basic/">
    AuthType Basic
    AuthName "PAM Authentication"
    AuthBasicProvider PAM
    AuthPAMService foreman
  </If>
  <Else>
    AuthType GSSAPI
    AuthName "GSSAPI Single Sign On Login"
    GssapiCredStore keytab:<%= @http_keytab %>
    GssapiSSLonly On
    GssapiLocalName <%= @gssapi_local_name %>
  </Else>
  require pam-account <%= scope.lookupvar('foreman::pam_service') %>
  ErrorDocument 401 '{ "error": "Kerberos authentication did not pass." }'
  # The following is needed as a workaround for https://bugzilla.redhat.com/show_bug.cgi?id=1020087
  ErrorDocument 500 '{ "error": "Kerberos authentication did not pass." }'
</LocationMatch>
